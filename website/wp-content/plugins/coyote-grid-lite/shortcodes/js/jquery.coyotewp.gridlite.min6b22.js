/**************************************************************************
 * jquery.coyotewp.grid.js - jQuery Plugin for Coyote Grid
 * @version: 1.0.0 (07.08.2015)
 * @requires jQuery v1.7 or later (tested on v1.11.3)
 * @author Coyote WP
**************************************************************************/
(function($){"use strict";$.fn.coygridlite=function(o){var defaults={width:700,height:300,animtype:'fade',animduration:450,animspeed:4000,automatic:true,showcontrols:true,centercontrols:true,nexttext:'Next',prevtext:'Prev',showmarkers:true,keyboardnav:true,hoverpause:true,randomstart:false,responsive:false,minFontLarge:null,maxFontLarge:null,minFontMedium:null,maxFontMedium:null};var settings=$.extend({},defaults,o);var $wrapper=this,$slider=$wrapper.find('ul.coygrid-lite'),$slides=$slider.children('li'),$c_wrapper=null,$c_fwd=null,$c_prev=null,$m_wrapper=null,$m_markers=null,$canvas=null,$clone_first=null,$clone_last=null;var state={slidecount:$slides.length,animating:false,paused:false,currentslide:1,nextslide:0,currentindex:0,nextindex:0,interval:null};var responsive={width:null,height:null,ratio:null};var vars={fwd:'forward',prev:'previous'};var init=function(){$slides.addClass('coygrid-slide-lite');if(settings.responsive){conf_responsive()}else{conf_static()}if(state.slidecount>1){if(settings.randomstart){conf_random()}if(settings.showcontrols){conf_controls()}if(settings.showmarkers){conf_markers()}if(settings.keyboardnav){conf_keynav()}if(settings.hoverpause&&settings.automatic){conf_hoverpause()}if(settings.animtype==='slide'){conf_slide()}}else{settings.automatic=false}if(settings.animtype==='slide'&&!settings.randomstart){state.currentindex=1;state.currentslide=2}$slider.show();$slides.eq(state.currentindex).show();if(settings.automatic){state.interval=setInterval(function(){go(vars.fwd,false)},settings.animspeed)}};var conf_responsive=function(){responsive.width=$wrapper.outerWidth();responsive.ratio=responsive.width/settings.width,responsive.height=settings.height*responsive.ratio;if(settings.animtype==='fade'){$slides.css({'height':settings.height,'width':'100%'});$slider.css({'height':settings.height,'width':'100%'});$wrapper.css({'height':settings.height,'max-width':settings.width,'position':'relative'});if(responsive.width<settings.width){$slides.css({'height':responsive.height,'max-width':responsive.width});$slider.css({'height':responsive.height});$wrapper.css({'height':responsive.height})}$(window).resize(function(){responsive.width=$wrapper.outerWidth(),responsive.ratio=responsive.width/settings.width,responsive.height=settings.height*responsive.ratio;$slides.css({'height':responsive.height,'max-width':responsive.width});$slider.css({'height':responsive.height,'width':responsive.width*settings.slidecount});$wrapper.css({'height':responsive.height,'max-width':settings.width})})}if(settings.animtype==='slide'){$slides.css({'height':settings.height,'width':settings.width});$slider.css({'height':settings.height,'width':settings.width*settings.slidecount});$wrapper.css({'height':settings.height,'max-width':settings.width,'position':'relative'});if(responsive.width<settings.width){$slides.css({'height':responsive.height,'max-width':responsive.width});$slider.css({'height':responsive.height});$wrapper.css({'height':responsive.height})}$(window).resize(function(){responsive.width=$wrapper.outerWidth(),responsive.ratio=responsive.width/settings.width,responsive.height=settings.height*responsive.ratio;$slides.css({'height':responsive.height,'width':responsive.width});$slider.css({'height':responsive.height,'width':responsive.width*settings.slidecount});$wrapper.css({'height':responsive.height});$canvas.css({'height':responsive.height,'width':responsive.width});resize_complete(function(){go(false,state.currentslide)},200,"some unique string")})}};var resize_complete=(function(){var timers={};return function(callback,ms,uniqueId){if(!uniqueId){uniqueId="Don't call this twice without a uniqueId"}if(timers[uniqueId]){clearTimeout(timers[uniqueId])}timers[uniqueId]=setTimeout(callback,ms)}})();var conf_static=function(){$slides.css({'height':settings.height,'width':settings.width});$slider.css({'height':settings.height,'width':settings.width});$wrapper.css({'height':settings.height,'width':settings.width,'position':'relative'})};var conf_slide=function(){$clone_first=$slides.eq(0).clone();$clone_last=$slides.eq(state.slidecount-1).clone();$clone_first.attr({'data-clone':'last','data-slide':0}).appendTo($slider).show();$clone_last.attr({'data-clone':'first','data-slide':0}).prependTo($slider).show();$slides=$slider.children('li');state.slidecount=$slides.length;$canvas=$('<div class="coygrid-wrapper-lite"></div>');if(settings.responsive&&(responsive.width<settings.width)){$canvas.css({'width':responsive.width,'height':responsive.height,'overflow':'hidden','position':'relative'});$slider.css({'width':responsive.width*(state.slidecount+2),'left':-responsive.width*state.currentslide})}else{$canvas.css({'width':settings.width,'height':settings.height,'overflow':'hidden','position':'relative'});$slider.css({'width':settings.width*(state.slidecount+2),'left':-settings.width*state.currentslide})}$slides.css({'float':'left','position':'relative','display':'list-item'});$canvas.prependTo($wrapper);$slider.appendTo($canvas)};var conf_controls=function(){$c_wrapper=$('<ul class="coygrid-controls-lite"></ul>');$c_fwd=$('<li class="coygrid-next-lite" data-direction="'+vars.fwd+'">'+settings.nexttext+'</li>');$c_prev=$('<li class="coygrid-prev-lite" data-direction="'+vars.prev+'">'+settings.prevtext+'</li>');$c_wrapper.on('click','li',function(e){e.preventDefault();var direction=$(this).attr('data-direction');if(!state.animating){if(direction===vars.fwd){go(vars.fwd,false)}if(direction===vars.prev){go(vars.prev,false)}}});$c_prev.appendTo($c_wrapper);$c_fwd.appendTo($c_wrapper);$c_wrapper.appendTo($wrapper);if(settings.centercontrols){$c_wrapper.addClass('v-centered-lite');var offset_px=($wrapper.height()-$c_fwd.children('a').outerHeight())/2,ratio=(offset_px/settings.height)*100,offset=ratio+'%';$c_fwd.find('a').css('top',offset);$c_prev.find('a').css('top',offset)}};var conf_markers=function(){$m_wrapper=$('<ol class="coygrid-markers-lite"></ol>');$.each($slides,function(key,slide){var slidenum=key+1,gotoslide=key+1;if(settings.animtype==='slide'){gotoslide=key+2}var marker=$('<li><a href="#">'+slidenum+'</a></li>');if(slidenum===state.currentslide){marker.addClass('active-marker-lite')}marker.on('click','a',function(e){e.preventDefault();if(!state.animating&&state.currentslide!==gotoslide){go(false,gotoslide)}});marker.appendTo($m_wrapper)});$m_wrapper.appendTo($wrapper);$m_markers=$m_wrapper.find('li')};var conf_keynav=function(){$(document).keyup(function(event){if(!state.paused){clearInterval(state.interval);state.paused=true}if(!state.animating){if(event.keyCode===39){event.preventDefault();go(vars.fwd,false)}else if(event.keyCode===37){event.preventDefault();go(vars.prev,false)}}if(state.paused&&settings.automatic){state.interval=setInterval(function(){go(vars.fwd)},settings.animspeed);state.paused=false}})};var conf_hoverpause=function(){$wrapper.hover(function(){if(!state.paused){clearInterval(state.interval);state.paused=true}},function(){if(state.paused){state.interval=setInterval(function(){go(vars.fwd,false)},settings.animspeed);state.paused=false}})};var conf_captions=function(){$.each($slides,function(key,slide){var caption=$(slide).children('img:first-child').attr('title');if(!caption){caption=$(slide).children('a').find('img:first-child').attr('title')}if(caption){caption=$('<p class="coygrid-caption-lite">'+caption+'</p>');caption.appendTo($(slide))}})};var conf_random=function(){var rand=Math.floor(Math.random()*state.slidecount)+1;state.currentslide=rand;state.currentindex=rand-1};var set_next=function(direction){if(direction===vars.fwd){if($slides.eq(state.currentindex).next().length){state.nextindex=state.currentindex+1;state.nextslide=state.currentslide+1}else{state.nextindex=0;state.nextslide=1}}else{if($slides.eq(state.currentindex).prev().length){state.nextindex=state.currentindex-1;state.nextslide=state.currentslide-1}else{state.nextindex=state.slidecount-1;state.nextslide=state.slidecount}}};var go=function(direction,position){if(!state.animating){state.animating=true;if(position){state.nextslide=position;state.nextindex=position-1}else{set_next(direction)}if(settings.animtype==='fade'){if(settings.showmarkers){$m_markers.removeClass('active-marker-lite');$m_markers.eq(state.nextindex).addClass('active-marker-lite')}$slides.eq(state.currentindex).fadeOut(settings.animduration);$slides.eq(state.nextindex).fadeIn(settings.animduration,function(){state.animating=false;state.currentslide=state.nextslide;state.currentindex=state.nextindex})}if(settings.animtype==='slide'){if(settings.showmarkers){var markerindex=state.nextindex-1;if(markerindex===state.slidecount-2){markerindex=0}else if(markerindex===-1){markerindex=state.slidecount-3}$m_markers.removeClass('active-marker-lite');$m_markers.eq(markerindex).addClass('active-marker-lite')}if(settings.responsive&&(responsive.width<settings.width)){state.slidewidth=responsive.width}else{state.slidewidth=settings.width}$slider.animate({'left':-state.nextindex*state.slidewidth},settings.animduration,function(){state.currentslide=state.nextslide;state.currentindex=state.nextindex;if($slides.eq(state.currentindex).attr('data-clone')==='last'){$slider.css({'left':-state.slidewidth});state.currentslide=2;state.currentindex=1}else if($slides.eq(state.currentindex).attr('data-clone')==='first'){$slider.css({'left':-state.slidewidth*(state.slidecount-2)});state.currentslide=state.slidecount-1;state.currentindex=state.slidecount-2}state.animating=false})}}};$('.coyote-grid-slider-lite').mouseenter(function(){$(this).find('.coygrid-prev-lite').addClass('fadeInLeft-prev-lite').removeClass('fadeInLeft-prev-reverse-lite');$(this).find('.coygrid-next-lite').addClass('fadeInRight-next-lite').removeClass('fadeInRight-next-reverse-lite')});$('.coyote-grid-slider-lite').mouseleave(function(){$(this).find('.coygrid-prev-lite').removeClass("fadeInLeft-prev-lite").addClass('fadeInLeft-prev-reverse-lite');$(this).find('.coygrid-next-lite').removeClass("fadeInRight-next-lite").addClass('fadeInRight-next-reverse-lite')});var WidthGrid=$wrapper.width();var WidthGridLarge=WidthGrid/2;var WidthGridMedium=WidthGrid/2;$(".coygrid-title-large-lite").each(function(index){var TextCount1=$(this).text().length;var RowsCalc1=TextCount1/3;var WidTextPixel1=WidthGridLarge/RowsCalc1;if(WidTextPixel1>settings.maxFontLarge){$(this).css({'font-size':settings.maxFontLarge})}else if(WidTextPixel1<settings.minFontLarge){$(this).css({'font-size':settings.minFontLarge})}else{$(this).css({'font-size':WidTextPixel1})}});$(".coygrid-title-medium-lite").each(function(index){var TextCount2=$(this).text().length;var RowsCalc2=TextCount2/3;var WidTextPixel2=WidthGridMedium/RowsCalc2;if(WidTextPixel2>settings.maxFontMedium){$(this).css({'font-size':settings.maxFontMedium})}else if(WidTextPixel2<settings.minFontMedium){$(this).css({'font-size':settings.minFontMedium})}else{$(this).css({'font-size':WidTextPixel2})}});$(window).resize(function(){var WidthGrid=$wrapper.width();var WidthGridLarge=WidthGrid/2;var WidthGridMedium=WidthGrid/2;$(".coygrid-title-large-lite").each(function(index){var TextCount1=$(this).text().length;var RowsCalc1=TextCount1/3;var WidTextPixel1=WidthGridLarge/RowsCalc1;if(WidTextPixel1>settings.maxFontLarge){$(this).css({'font-size':settings.maxFontLarge})}else if(WidTextPixel1<settings.minFontLarge){$(this).css({'font-size':settings.minFontLarge})}else{$(this).css({'font-size':WidTextPixel1})}});$(".coygrid-title-medium-lite").each(function(index){var TextCount2=$(this).text().length;var RowsCalc2=TextCount2/3;var WidTextPixel2=WidthGridMedium/RowsCalc2;if(WidTextPixel2>settings.maxFontMedium){$(this).css({'font-size':settings.maxFontMedium})}else if(WidTextPixel2<settings.minFontMedium){$(this).css({'font-size':settings.minFontMedium})}else{$(this).css({'font-size':WidTextPixel2})}})});init()}})(jQuery);